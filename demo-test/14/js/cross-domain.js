(function(e,t){(function(e,t){var n,r,o,i,s,a,u,c,f,l,d,p,h,y,v,g,m,b,x,w,E,k=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};v=e.document,r="before",n="after",l="readyState",f="addEventListener",c="removeEventListener",s="dispatchEvent",h="XMLHttpRequest",a="FormData",d=["load","loadend","loadstart"],o=["progress","abort","error","timeout"],(E=Array.prototype).indexOf||(E.indexOf=function(e){var t,n,r,o;for(t=r=0,o=this.length;o>r;t=++r)if(n=this[t],n===e)return t;return-1}),x=function(e,t){return Array.prototype.slice.call(e,t)},m=function(e,t){var n,r;for(n in e)if(r=e[n],"returnValue"!==n)try{t[n]=e[n]}catch(o){}return t},b=function(e,t,n){var r,o,i,a;for(o=function(e){return function(r){var o,i,a;o={};for(i in r)"returnValue"!==i&&(a=r[i],o[i]=a===t?n:a);return n[s](e,o)}},i=0,a=e.length;a>i;i++)r=e[i],t["on"+r]=o(r)},g=function(e){var t;if(null!=v.createEventObject)return t=v.createEventObject(),t.type=e,t;try{return new Event(e)}catch(n){return{type:e}}},i=function(e){var n,r,o;return r={},o=function(e){return r[e]||[]},n={},n[f]=function(e,n,i){r[e]=o(e),r[e].indexOf(n)>=0||(i=i===t?r[e].length:i,r[e].splice(i,0,n))},n[c]=function(e,t){var n;n=o(e).indexOf(t),-1!==n&&o(e).splice(n,1)},n[s]=function(){var r,i,s,a,u,c,f,l;for(r=x(arguments),i=r.shift(),e||(r[0]=m(r[0],g(i))),a=n["on"+i],a&&a.apply(t,r),l=o(i).concat(o("*")),s=c=0,f=l.length;f>c;s=++c)u=l[s],u.apply(t,r)},e&&(n.listeners=function(e){return x(o(e))},n.on=n[f],n.off=n[c],n.fire=n[s],n.once=function(e,t){var r;return r=function(){return n.off(e,r),t.apply(null,arguments)},n.on(e,r)},n.destroy=function(){return r={}}),n},w=i(!0),w.EventEmitter=i,w[r]=function(e,t){if(e.length<1||e.length>2)throw"invalid hook";return w[f](r,e,t)},w[n]=function(e,t){if(e.length<2||e.length>3)throw"invalid hook";return w[f](n,e,t)},w.enable=function(){e[h]=p},w.disable=function(){e[h]=w[h]},y=w.headers=function(e,t){var n,r,o,i,s,a,u,c,f;switch(null==t&&(t={}),typeof e){case"object":r=[];for(o in e)s=e[o],i=o.toLowerCase(),r.push(""+i+":	"+s);return r.join("\n");case"string":for(r=e.split("\n"),u=0,c=r.length;c>u;u++)n=r[u],/([^:]+):\s*(.+)/.test(n)&&(i=null!=(f=RegExp.$1)?f.toLowerCase():void 0,a=RegExp.$2,null==t[i]&&(t[i]=a));return t}},u=e[a],u&&(w[a]=u,e[a]=function(e){var t;this.fd=e?new u(e):new u,this.form=e,t=[],Object.defineProperty(this,"entries",{get:function(){var n;return n=e?x(e.querySelectorAll("input,select")).filter(function(e){var t;return"checkbox"!==(t=e.type)&&"radio"!==t||e.checked}).map(function(e){return[e.name,"file"===e.type?e.files:e.value]}):[],n.concat(t)}}),this.append=function(e){return function(){var n;return n=x(arguments),t.push(n),e.fd.append.apply(e.fd,n)}}(this)}),w[h]=e[h],p=e[h]=function(){var t,u,c,p,v,g,x,E,T,L,C,R,O,q,A;return A=new w[h],v=!1,R=!1,T={},T.headers={},T.headerNames={},L={},L.headers={},E=function(){var e,t,n,r;L.status=A.status,L.statusText=A.statusText,r=y(A.getAllResponseHeaders());for(e in r)n=r[e],L.headers[e]||(t=e.toLowerCase(),L.headers[t]=n)},x=function(){try{L.text=A.responseText}catch(e){}try{L.xml=A.responseXML}catch(e){}L.data=A.response||L.text},q=function(){p.status=L.status,p.statusText=L.statusText},O=function(){L.hasOwnProperty("text")&&(p.responseText=L.text),L.hasOwnProperty("xml")&&(p.responseXML=L.xml),p.response=L.data||null},c=function(e){for(;e>t&&4>t;)p[l]=++t,1===t&&p[s]("loadstart",{}),2===t&&q(),4===t&&(q(),O()),p[s]("readystatechange",{}),4===t&&setTimeout(u,0)},u=function(){v||p[s]("load",{}),p[s]("loadend",{}),v&&(p[l]=0)},t=0,C=function(e){var t,r;return 4!==e?void c(e):(t=w.listeners(n),r=function(){var e;return t.length?(e=t.shift(),2===e.length?(e(T,L),r()):3===e.length&&T.async?e(T,L,r):r()):c(4)},void r())},p=T.xhr=i(),A.onreadystatechange=function(){try{2===A[l]&&E()}catch(e){}4===A[l]&&(R=!1,E(),x()),C(A[l])},g=function(){v=!0},p[f]("error",g),p[f]("timeout",g),p[f]("abort",g),p[f]("progress",function(){3>t?C(3):p[s]("readystatechange",{})}),b(o,A,p),("withCredentials"in A||w.addWithCredentials)&&(p.withCredentials=!1),p.status=0,p.open=function(e,t,n,r,o){T.method=e,T.url=t,T.async=n!==!1,T.user=r,T.pass=o,C(1)},p.send=function(t){var n,o,i,s,u,c,f,l;for(l=["type","timeout","withCredentials"],c=0,f=l.length;f>c;c++)o=l[c],i="type"===o?"responseType":o,i in p&&(T[o]=p[i]);T.body=t,u=function(){var t,n,r,s,u,c;for(R=!0,A.open(T.method,T.url,T.async,T.user,T.pass),u=["type","timeout","withCredentials"],r=0,s=u.length;s>r;r++)o=u[r],i="type"===o?"responseType":o,o in T&&(A[i]=T[o]);c=T.headers;for(t in c)n=c[t],A.setRequestHeader(t,n);e[a]&&T.body instanceof e[a]&&(T.body=T.body.fd),A.send(T.body)},n=w.listeners(r),(s=function(){var e,t;return n.length?(e=function(e){return"object"!=typeof e||"number"!=typeof e.status&&"number"!=typeof L.status?void s():(m(e,L),k.call(e,"data")<0&&(e.data=e.response||e.text),void C(4))},e.head=function(e){return m(e,L),C(2)},e.progress=function(e){return m(e,L),C(3)},t=n.shift(),1===t.length?e(t(T)):2===t.length&&T.async?t(T,e):e()):u()})()},p.abort=function(){R?A.abort():p[s]("abort",{})},p.setRequestHeader=function(e,t){var n,r;n=null!=e?e.toLowerCase():void 0,r=T.headerNames[n]=T.headerNames[n]||e,T.headers[r]&&(t=T.headers[r]+", "+t),T.headers[r]=t},p.getResponseHeader=function(e){var t;return t=null!=e?e.toLowerCase():void 0,L.headers[t]},p.getAllResponseHeaders=function(){return y(L.headers)},A.overrideMimeType&&(p.overrideMimeType=function(){return A.overrideMimeType.apply(A,arguments)}),A.upload&&(p.upload=T.upload=i(),b(o.concat(d),A.upload,p.upload)),p},"function"==typeof this.define&&this.define.amd?define("Cross-domain.js",[],function(){return w}):(this.exports||this).xhook=w}).call(this,e);var n,r,o,i,s,a,u,c,f,l,d,p,h,y,v,g,m,b,x,w,E,k,T,L,C,R,O,q,A,M,D,X,H,j,N,B,F,S;O=null,s=function(e){var t,n;null===O&&(O={},g());for(t in e)n=e[t],k("adding slave: "+t),O[t]=n},p={},h=function(e,t){var n;return p[e]?p[e]:(n=l.createElement("iframe"),n.id=n.name=y(),k("creating iframe "+n.id),n.src=""+e+t,n.setAttribute("style","display:none;"),n.setAttribute("class","hb-cross-iframe"),l.body.appendChild(n),p[e]=n.contentWindow)},g=function(){var e,t,n;return t=function(e,t){var n,r,o,i,s;return o=e[0],i=e[1],n=b(i,"Blob"),r=b(i,"File"),n||r?(s=new FileReader,s.onload=function(){return e[1]=null,r&&(e[2]=i.name),t(["XD_BLOB",e,this.result,i.type])},s.readAsArrayBuffer(i),1):0},e=function(e,n){var r;e.forEach(function(t,n){var r,o,i,s,a;if(o=t[0],i=t[1],b(i,"FileList"))for(e.splice(n,1),s=0,a=i.length;a>s;s++)r=i[s],e.splice(n,0,[o,r])}),r=0,e.forEach(function(o,i){r+=t(o,function(t){e[i]=t,0===--r&&n()})}),0===r&&n()},n=function(t,n){var r,o,i;return n.on("xhr-event",function(){return t.xhr.dispatchEvent.apply(null,arguments)}),n.on("xhr-upload-event",function(){return t.xhr.upload.dispatchEvent.apply(null,arguments)}),o=D(t),o.headers=t.headers,t.withCredentials&&(o.credentials=l.cookie),i=function(){return n.emit("request",o)},t.body&&(o.body=t.body,b(o.body,"FormData"))?(r=o.body.entries,o.body=["XD_FD",r],void e(r,i)):void i()},N.addWithCredentials=!0,N.before(function(e,t){var r,o,i;return o=R(e.url),o&&o.origin!==f?O[o.origin]?(k("proxying request to slave: '"+o.origin+"'"),e.async===!1?(H("sync not supported"),t()):(r=h(o.origin,O[o.origin]),i=a(r),i.on("response",function(e){return t(e),i.close()}),e.xhr.addEventListener("abort",function(){return i.emit("abort")}),void(i.ready?n(e,i):i.once("ready",function(){return n(e,i)})))):(o&&k("no slave matching: '"+o.origin+"'"),t()):t()})},L=null,i=function(e){var t,n;null===L&&(L={},m());for(t in e)n=e[t],k("adding master: "+t),L[t]=n},m=function(){return w(function(e,t){var n,r,o,i;"null"===e&&(e="*"),o=null;for(n in L){i=L[n];try{if(r=X(n),r.test(e)){o=X(i);break}}catch(s){}}return o?(t.once("request",function(e){var n,r,i,s,a,u,c,f,l,d,p;if(k("request: "+e.method+" "+e.url),u=R(e.url),!u||!o.test(u.path))return H("blocked request to path: '"+u.path+"' by regex: "+o),void t.close();f=new XMLHttpRequest,f.open(e.method,e.url),f.addEventListener("*",function(e){return t.emit("xhr-event",e.type,D(e))}),f.upload&&f.upload.addEventListener("*",function(e){return t.emit("xhr-upload-event",e.type,D(e))}),t.once("abort",function(){return f.abort()}),f.onreadystatechange=function(){var e;if(4===f.readyState){e={status:f.status,statusText:f.statusText,data:f.response,headers:N.headers(f.getAllResponseHeaders())};try{e.text=f.responseText}catch(n){}return t.emit("response",e)}},e.withCredentials&&(e.headers["XDomain-Cookie"]=e.credentials),e.timeout&&(f.timeout=e.timeout),e.type&&(f.responseType=e.type),p=e.headers;for(a in p)c=p[a],f.setRequestHeader(a,c);if(e.body instanceof Array&&"XD_FD"===e.body[0]){for(s=new N.FormData,i=e.body[1],l=0,d=i.length;d>l;l++)n=i[l],"XD_BLOB"===n[0]&&4===n.length&&(r=new Blob([n[2]],{type:n[3]}),n=n[1],n[1]=r),s.append.apply(s,n);e.body=s}f.send(e.body||null)}),void k("slave listening for requests on socket: "+t.id)):void H("blocked request from: '"+e+"'")}),e===e.parent?H("slaves must be in an iframe"):e.parent.postMessage("XDPING_"+r,"*")},C=function(t){return l.addEventListener?e.addEventListener("message",t):e.attachEvent("onmessage",t)},o="XD_CHECK",v=null,A={},x=!0,M=function(){return C(function(e){var n,o,i,s;if(n=e.data,"string"==typeof n){if(/^XDPING(_(V\d+))?$/.test(n)&&RegExp.$2!==r)return H("your master is not compatible with your slave, check your cross.js version");if(/^cross-/.test(n))n=n.split(",");else if(x)try{n=JSON.parse(n)}catch(a){return}}if(n instanceof Array&&(i=n.shift(),/^cross-/.test(i)&&(s=A[i],null!==s))){if(s===t){if(!v)return;s=c(i,e.source),v(e.origin,s)}o="string"==typeof n[1]?": '"+n[1]+"'":"",k("receive socket: "+i+": '"+n[0]+"'"+o),s.fire.apply(s,n)}})},c=function(e,t){var r,i,s,a,u,c;return u=!1,c=A[e]=N.EventEmitter(!0),c.id=e,c.once("close",function(){return c.destroy(),c.close()}),a=[],c.emit=function(){var t,n;t=q(arguments),n="string"==typeof t[1]?": '"+t[1]+"'":"",k("send socket: "+e+": "+t[0]+n),t.unshift(e),u?s(t):a.push(t)},s=function(e){x&&(e=JSON.stringify(e)),t.postMessage(e,"*")},c.close=function(){c.emit("close"),k("close socket: "+e),A[e]=null},c.once(o,function(t){for(x="string"==typeof t,u=c.ready=!0,c.emit("ready"),k("ready socket: "+e+" (emit #"+a.length+" pending)");a.length;)s(a.shift())}),i=0,r=function(){return function(){t.postMessage([e,o,{}],"*"),u||(i++===j.timeout/n?H("Timeout waiting on iframe socket"):setTimeout(r,n))}}(this),setTimeout(r),k("new socket: "+e),c},a=function(e){var t;return t=c(y(),e)},w=function(e){v=e},N=(this.exports||this).xhook,j=function(e){e&&(e.masters&&i(e.masters),e.slaves&&s(e.slaves))},j.masters=i,j.slaves=s,j.debug=!1,j.timeout=15e3,n=100,l=e.document,E=e.location,f=j.origin=E.protocol+"//"+E.host,y=function(){return"cross-"+Math.round(Math.random()*Math.pow(2,32)).toString(16)},q=function(e,t){return Array.prototype.slice.call(e,t)},u=e.console||{},T=function(e){return function(t){t="cross ("+f+"): "+t,e in j&&j[e](t),("log"!==e||j.debug)&&e in u&&u[e](t)}},k=T("log"),H=T("warn"),S=["postMessage","JSON"];for(B=0,F=S.length;F>B;B++)if(d=S[B],!e[d])return void H("requires '"+d+"' and this browser does not support it");b=function(t,n){return n in e?t instanceof e[n]:!1},r="V1",R=j.parseUrl=function(e){return/^((https?:)?\/\/[^\/\?]+)(\/.*)?/.test(e)?{origin:(RegExp.$2?"":E.protocol)+RegExp.$1,path:RegExp.$3}:(k("failed to parse absolute url: "+e),null)},X=function(e){var t;return e instanceof RegExp?e:(t=e.toString().replace(/\W/g,function(e){return"\\"+e}).replace(/\\\*/g,".*"),new RegExp("^"+t+"$"))},D=function(e){var t,n,r,o;t={};for(n in e)"returnValue"!==n&&(r=e[n],"function"!=(o=typeof r)&&"object"!==o&&(t[n]=r));return t},function(){var e,t,n,r,o,a,u,c,f,d,p;for(e={debug:function(e){return"string"==typeof e?j.debug="false"!==e:void 0},slave:function(e){var t,n;if(e&&(t=R(e)))return n={},n[t.origin]=t.path,s(n)},master:function(e){var t,n;if(e&&(n="*"===e?{origin:"*",path:"*"}:R(e)))return t={},t[n.origin]=n.path.replace(/^\//,"")?n.path:"*",i(t)}},d=l.getElementsByTagName("script"),a=0,c=d.length;c>a;a++)if(o=d[a],/cross/.test(o.src))for(p=["","data-"],u=0,f=p.length;f>u;u++){r=p[u];for(n in e)(t=e[n])(o.getAttribute(r+n))}}(),M(),"function"==typeof this.define&&this.define.amd?define("cross",["xhook"],function(e){return N=e,j}):(this.exports||this).cross=j}).call(this,window);